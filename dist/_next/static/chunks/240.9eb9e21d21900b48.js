"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[240],{3713:(e,t,a)=>{a.d(t,{BT:()=>c,Wu:()=>o,ZB:()=>i,Zp:()=>n,aR:()=>s,wL:()=>d});var r=a(8045);a(5177);var l=a(6816);function n(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card",className:(0,l.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function s(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,l.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function i(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:(0,l.cn)("leading-none font-semibold",t),...a})}function c(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:(0,l.cn)("text-muted-foreground text-sm",t),...a})}function o(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,l.cn)("px-6",t),...a})}function d(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-footer",className:(0,l.cn)("flex items-center px-6 [.border-t]:pt-6",t),...a})}},7859:(e,t,a)=>{a.r(t),a.d(t,{default:()=>D});var r=a(8045),l=a(5177),n=a(3713),s=a(1266);function i(e){let{url:t,metadata:a}=e,i=(0,l.useMemo)(()=>(function(e){try{let t=new URL(e);if("http:"===t.protocol||"https:"===t.protocol)return t.toString();return null}catch(e){return null}})(t),[t]),[c,o]=(0,l.useState)(!1),d=(0,l.useRef)(null),[u,h]=(0,l.useState)(1),[x,m]=(0,l.useState)(()=>(0,s.OG)(s.di).height),f=(0,l.useMemo)(()=>{if("number"==typeof(null==a?void 0:a.width)&&"number"==typeof(null==a?void 0:a.height))return{width:a.width,height:a.height};let e=null==a?void 0:a.viewport;return e&&s.y8[e]?(0,s.OG)(e):(0,s.OG)(s.di)},[null==a?void 0:a.height,null==a?void 0:a.width,null==a?void 0:a.viewport]),v=(0,l.useMemo)(()=>{try{return new URL(i||"").hostname}catch(e){return i}},[i]);return((0,l.useLayoutEffect)(()=>{let e=d.current;if(!e)return;let t=()=>{let t=e.clientWidth;if(!t||!f.width)return;let a=t/f.width;h(a),m(f.height*a)};t();let a=null;return"undefined"!=typeof ResizeObserver?(a=new ResizeObserver(()=>t())).observe(e):window.addEventListener("resize",t),()=>{null==a||a.disconnect(),window.removeEventListener("resize",t)}},[f.height,f.width]),i)?c?(0,r.jsx)("div",{ref:d,className:"w-full flex items-start",children:(0,r.jsxs)(n.Zp,{className:"max-w-xl w-full bg-white/80 backdrop-blur border border-white/20 shadow-2xl",children:[(0,r.jsx)(n.aR,{children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 flex-shrink-0 bg-gray-200 rounded flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsx)(n.ZB,{className:"text-gray-900 truncate text-base",children:v}),(0,r.jsx)(n.BT,{className:"text-gray-600 truncate mt-1",children:i}),c&&(0,r.jsx)("div",{className:"mt-2 text-xs text-amber-600 bg-amber-50 px-2 py-1 rounded",children:"⚠️ This site cannot be embedded. Click below to open."})]})]})}),(0,r.jsx)(n.wL,{className:"pt-0",children:(0,r.jsx)("a",{href:i,target:"_blank",rel:"noreferrer noopener",className:"text-blue-600 hover:underline text-sm font-medium",children:"Open in new tab →"})})]})}):(0,r.jsx)("div",{ref:d,className:"w-full",style:{position:"relative",height:"".concat(x,"px"),overflow:"hidden"},children:(0,r.jsx)("div",{className:"shadow-2xl border border-white/10",style:{position:"absolute",top:0,left:0,width:"".concat(f.width,"px"),height:"".concat(f.height,"px"),transform:"scale(".concat(u,")"),transformOrigin:"top left",pointerEvents:"auto"},children:(0,r.jsx)("iframe",{src:i,width:f.width,height:f.height,className:"w-full h-full",allow:"clipboard-write; fullscreen; autoplay; encrypted-media; picture-in-picture",referrerPolicy:"no-referrer-when-downgrade",style:{border:0},onError:()=>o(!0)})})}):(0,r.jsx)("div",{className:"p-4 text-sm text-red-600",children:"Invalid URL"})}var c=a(2989);function o(e){let{src:t,alt:a}=e,n=(0,l.useMemo)(()=>(function(e){try{return new URL(e).hostname.includes("quick.shopify.io")}catch(e){return!1}})(t),[t]),s="w-full h-auto";return n?(0,r.jsx)(c.default,{src:t,alt:a||"",width:2e3,height:1500,className:s}):(0,r.jsx)("img",{src:t,alt:a||"",className:s})}function d(e){let{src:t,poster:a,metadata:n}=e,s=(0,l.useRef)(null),i=!(null==n?void 0:n.hideUI),c=(null==n?void 0:n.loop)||!1,o=(null==n?void 0:n.muted)!==!1;return(0,l.useEffect)(()=>{let e=s.current;if(!e||!c)return;let t=async()=>{try{await e.play()}catch(e){console.log("Auto-play blocked for looping video:",e)}};return e.readyState>=1?t():e.addEventListener("loadedmetadata",t,{once:!0}),()=>{e.removeEventListener("loadedmetadata",t)}},[c,t]),(0,r.jsx)("video",{ref:s,src:t,poster:a,controls:i,loop:c,muted:o,playsInline:!0,className:"w-full h-auto cursor-pointer",onClick:()=>{if(i)return;let e=s.current;e&&(e.paused?e.play():e.pause())}})}function u(e){let{src:t}=e;return(0,r.jsx)("iframe",{src:"".concat(t,"#toolbar=0&navpanes=0"),className:"w-full h-auto",allow:"fullscreen"})}var h=a(3173),x=a(9155),m=a(9966),f=a(9208),v=a(7651);function p(e){let{title:t,artifactId:a,onUpdate:n,className:s="",artifactType:i,sourceUrl:c}=e,[o,d]=(0,l.useState)(!1),[u,p]=(0,l.useState)(t),[g,w]=(0,l.useState)(!1),y=(0,l.useRef)(null);(0,l.useEffect)(()=>{p(t)},[t]),(0,l.useEffect)(()=>{o&&y.current&&(y.current.focus(),y.current.select())},[o]);let j=(0,l.useCallback)(()=>{d(!0)},[]),b=(0,l.useCallback)(async()=>{if(u.trim()===t.trim())return void d(!1);w(!0);try{await n(u.trim()||"Untitled"),d(!1),u.trim()!==t.trim()&&v.oR.success("Artifact title updated")}catch(e){v.oR.error("Failed to update title. Please try again."),console.error("Failed to update artifact title:",e),p(t)}finally{w(!1)}},[u,t,n]),N=(0,l.useCallback)(()=>{p(t),d(!1)},[t]),k=(0,l.useCallback)(e=>{"Enter"===e.key?(e.preventDefault(),b()):"Escape"===e.key&&(e.preventDefault(),N())},[b,N]),C=(0,l.useCallback)(()=>{b()},[b]),R="url"===i;return o?(0,r.jsx)("div",{className:"text-center ".concat(s),children:(0,r.jsx)(h.p,{ref:y,type:"text",value:u,onChange:e=>p(e.target.value),onKeyDown:k,onBlur:C,disabled:g,placeholder:"Untitled",className:"h-6 text-xs text-center bg-transparent border-0 focus:bg-white focus:text-gray-800 focus:border-gray-300 px-1 py-0.5 min-w-0 w-full max-w-full",style:{fontSize:"14px",lineHeight:"1.2",minWidth:"60px",maxWidth:"440px"}})}):(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2 ".concat(s),children:[R&&(0,r.jsx)(m.A,{className:"h-4 w-4 text-gray-400 flex-shrink-0"}),(0,r.jsx)("div",{className:"cursor-pointer hover:bg-white/5 rounded-md px-2 py-1 transition-colors duration-200 flex-1 min-w-0",onDoubleClick:j,title:"Double-click to edit",children:(0,r.jsx)("div",{className:"text-xs text-gray-400 truncate select-none",style:{fontSize:"14px",lineHeight:"1.2"},children:u||"Untitled"})}),R&&c&&(0,r.jsx)(x.$,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 flex-shrink-0 text-gray-500 hover:text-gray-300 hover:bg-white/10",onClick:e=>{e.stopPropagation(),window.open(c,"_blank","noopener,noreferrer")},"aria-label":"Open in new tab",children:(0,r.jsx)(f.A,{className:"h-3.5 w-3.5"})})]})}var g=a(6436),w=a(6655),y=a(4922),j=a(5078),b=a(5376),N=a(6174),k=a(3816),C=a(1003),R=a(9317),E=a(4326),S=a(557),L=a(4513);function A(e){let{artifact:t,width:a,columnHeight:l,isGlobalDragActive:n,activeArtifactId:s,children:i}=e,{attributes:c,listeners:o,setNodeRef:d,transform:u,transition:h,isDragging:x}=(0,R.gl)({id:t.id}),m=null!==u,f=x&&n;(x||n)&&console.log("[Artifact ".concat(t.id.slice(0,8),"] isDragging: ").concat(x,", isGlobalDragActive: ").concat(n,", shouldDim: ").concat(f));let v={width:a,minHeight:"100%",scrollSnapAlign:"start",transition:n&&m?h:void 0,transform:S.Ks.Transform.toString(u),cursor:x?"grabbing":"grab",touchAction:"manipulation"};return(0,r.jsx)(L.P.div,{ref:d,style:v,"data-artifact-id":t.id,className:"inline-flex flex-col align-top shrink-0 h-full",layout:!n,transition:{layout:{type:"spring",bounce:.15,duration:.4}},...c,...o,children:(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)("div",{className:"overflow-y-auto",style:{maxHeight:l?"".concat(l,"px"):void 0},children:(0,r.jsxs)("div",{className:"overflow-hidden dim-overlay-parent relative",children:[i,f&&(0,r.jsx)("style",{dangerouslySetInnerHTML:{__html:'\n                  [data-artifact-id="'.concat(t.id,'"] [data-artifact-overlay-container="true"]::after {\n                    content: "";\n                    position: absolute;\n                    inset: 0;\n                    background: black;\n                    opacity: 0.9;\n                    pointer-events: none;\n                    z-index: 10;\n                  }\n                ')}})]})})})})}function _(e){let{artifact:t,maxHeight:a}=e;return(0,r.jsx)("div",{className:"pointer-events-none overflow-y-auto",style:{maxHeight:a?"".concat(a,"px"):void 0},children:(0,r.jsx)("div",{className:"overflow-hidden",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("div",{className:"text-xs text-gray-400 truncate select-none px-2 py-1",style:{fontSize:"14px",lineHeight:"1.2",maxWidth:"440px",margin:"0 auto"},children:t.name||"Untitled"})})}),(0,r.jsx)("div",{children:(0,r.jsx)(U,{artifact:t})})]})})})}function U(e){let{artifact:t}=e;return"image"===t.type?(0,r.jsx)(o,{src:t.source_url,alt:""}):"url"===t.type?(0,r.jsx)(i,{url:t.source_url}):"video"===t.type?(0,r.jsx)(d,{src:t.source_url}):"pdf"===t.type?(0,r.jsx)(u,{src:t.source_url}):(0,r.jsx)("div",{className:"text-sm text-white/70",children:"Unsupported"})}function D(e){let{columns:t,artifacts:a,onReorder:n,onUpdateArtifact:s,onDeleteArtifact:i,isReadOnly:c=!1}=e,[o,d]=(0,l.useState)(a),[u,h]=(0,l.useState)(null),[x,m]=(0,l.useState)(!1),f=(0,l.useRef)(null);(0,l.useEffect)(()=>{d(a)},[a]);let S=(0,C.FR)((0,C.MS)(C.AN,{activationConstraint:{distance:6},...c?{activationConstraint:{distance:999999}}:{}})),[L,U]=(0,l.useState)(!1),[D,z]=(0,l.useState)(null);(0,l.useEffect)(()=>{let e=window.matchMedia("(any-pointer: coarse)"),t=()=>U(e.matches);t(),e.addEventListener("change",t);let a=()=>{U(!1),window.removeEventListener("wheel",a)};return window.addEventListener("wheel",a,{passive:!0}),()=>{e.removeEventListener("change",t),window.removeEventListener("wheel",a)}},[]),(0,l.useLayoutEffect)(()=>{let e=f.current;if(!e)return;let t=()=>z(e.clientHeight);t();let a=()=>t(),r=null;return"undefined"!=typeof ResizeObserver?(r=new ResizeObserver(a)).observe(e):window.addEventListener("resize",a),()=>{null==r||r.disconnect(),window.removeEventListener("resize",a)}},[o.length]);let H=(0,l.useMemo)(()=>"calc((100% - ".concat((t-1)*32,"px) / ").concat(t,")"),[t,32]),M=(0,l.useCallback)(e=>{let{active:t,over:a}=e;console.log("[Canvas] handleDragEnd called - clearing state immediately"),h(null),m(!1),a&&t.id!==a.id&&d(e=>{let r=e.findIndex(e=>e.id===t.id),l=e.findIndex(e=>e.id===a.id);if(-1===r||-1===l)return e;let s=(0,R.be)(e,r,l);return null==n||n(s),s})},[n]),O=(0,l.useCallback)(e=>{console.log("[Canvas] handleDragStart called"),h(e.active.id),m(!0)},[]),B=(0,l.useCallback)(e=>{let t=f.current,a=e.active.rect.current.translated;if(!t||!a)return;let r=t.getBoundingClientRect();a.right>r.right-120?t.scrollBy({left:28,behavior:"auto"}):a.left<r.left+120&&t.scrollBy({left:-28,behavior:"auto"})},[]),F=(0,l.useCallback)(e=>{let{artifact:t,children:a}=e,l="video"===t.type,n=t.metadata;if(c)return(0,r.jsx)("div",{className:"group relative",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{"data-artifact-title-id":t.id,children:(0,r.jsx)("div",{className:"mb-6 text-white/80 text-sm font-medium text-center",children:t.name})}),(0,r.jsx)("div",{className:"relative","data-artifact-overlay-container":"true",children:a})]})});let o=async()=>{if(!s)return;let e={...t.metadata,hideUI:!(null==n?void 0:n.hideUI)};try{await s(t.id,{metadata:e}),v.oR.success((null==n?void 0:n.hideUI)?"Video controls enabled":"Video controls hidden")}catch(e){v.oR.error("Failed to update video settings")}},d=async()=>{if(!s)return;let e={...t.metadata,loop:!(null==n?void 0:n.loop)};try{await s(t.id,{metadata:e}),v.oR.success((null==n?void 0:n.loop)?"Video loop disabled":"Video loop enabled")}catch(e){v.oR.error("Failed to update video settings")}},u=async()=>{if(!s)return;let e=(null==n?void 0:n.muted)!==!1,a={...t.metadata,muted:!e};try{await s(t.id,{metadata:a}),v.oR.success(e?"Video unmuted":"Video muted")}catch(e){v.oR.error("Failed to update video settings")}};return(0,r.jsxs)(g.tz,{children:[(0,r.jsx)(g.Rc,{asChild:!0,children:(0,r.jsx)("div",{className:"group relative",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{"data-artifact-title-id":t.id,children:(0,r.jsx)(p,{title:t.name,artifactId:t.id,onUpdate:e=>{var a;return null!=(a=null==s?void 0:s(t.id,{name:e}))?a:Promise.resolve()},artifactType:t.type,sourceUrl:t.source_url,className:"mb-6"})}),(0,r.jsx)("div",{className:"relative","data-artifact-overlay-container":"true",children:a})]})})}),(0,r.jsxs)(g.Ip,{children:[l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(g.kt,{onClick:o,className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(null==n?void 0:n.hideUI)?null:(0,r.jsx)(w.A,{className:"w-3 h-3"})}),(null==n?void 0:n.hideUI)?(0,r.jsx)(j.A,{className:"w-4 h-4"}):(0,r.jsx)(y.A,{className:"w-4 h-4"}),"Show Controls"]}),(0,r.jsxs)(g.kt,{onClick:d,className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(null==n?void 0:n.loop)?(0,r.jsx)(w.A,{className:"w-3 h-3"}):null}),(0,r.jsx)(b.A,{className:"w-4 h-4"}),"Loop Video"]}),(0,r.jsxs)(g.kt,{onClick:u,className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(null==n?void 0:n.muted)===!1?(0,r.jsx)(w.A,{className:"w-3 h-3"}):null}),(null==n?void 0:n.muted)!==!1?(0,r.jsx)(N.A,{className:"w-4 h-4"}):(0,r.jsx)(k.A,{className:"w-4 h-4"}),"Audio On"]}),(0,r.jsx)(g.kt,{disabled:!0,className:"h-px bg-border p-0 m-1"})]}),(0,r.jsx)(g.kt,{variant:"destructive",onClick:async()=>{try{await (null==i?void 0:i(t.id)),v.oR.success('"'.concat(t.name,'" deleted successfully'))}catch(e){v.oR.error("Failed to delete artifact. Please try again."),console.error("Failed to delete artifact:",e)}},children:"Delete"})]})]})},[s,i,c]);return 0===o.length?(0,r.jsx)("div",{className:"h-full flex items-center justify-center text-white/60",children:"No artifacts yet. Add one to get started."}):(0,r.jsxs)(C.Mp,{sensors:S,collisionDetection:C.fp,onDragStart:O,onDragMove:B,onDragEnd:M,children:[(0,r.jsx)("div",{className:"h-full",children:(0,r.jsx)(E.o,{children:(0,r.jsx)("div",{ref:f,className:"w-full h-full overflow-x-auto overflow-y-hidden flex items-stretch ".concat(L?"":"hide-scrollbar"),style:{gap:"".concat(32,"px"),scrollSnapType:x?"none":"x mandatory",scrollPaddingInline:"".concat(32,"px"),paddingInline:"".concat(32,"px")},children:(0,r.jsx)(R.gB,{items:o.map(e=>e.id),strategy:R.m$,children:o.map(e=>(0,r.jsx)(A,{artifact:e,width:H,columnHeight:null!=D?D:void 0,isGlobalDragActive:x,activeArtifactId:u,children:(0,r.jsx)(F,{artifact:e,children:(0,r.jsx)(I,{artifact:e})})},e.id))})})})}),(0,r.jsx)(C.Hd,{children:u?(0,r.jsx)(_,{artifact:o.find(e=>e.id===u),maxHeight:null!=D?D:void 0}):null})]})}function I(e){let{artifact:t}=e;return"image"===t.type?(0,r.jsx)(o,{src:t.source_url,alt:""}):"url"===t.type?(0,r.jsx)(i,{url:t.source_url,metadata:t.metadata}):"video"===t.type?(0,r.jsx)(d,{src:t.source_url,metadata:t.metadata}):"pdf"===t.type?(0,r.jsx)(u,{src:t.source_url}):(0,r.jsxs)("div",{className:"h-full flex items-center justify-center text-sm text-gray-500",children:["Unsupported type: ",t.type]})}}}]);