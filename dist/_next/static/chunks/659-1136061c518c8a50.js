"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[659],{626:(t,e,a)=>{a.d(e,{yv:()=>n});async function n(){return window.quick?window.quick:new Promise(t=>{let e=()=>{window.quick?t(window.quick):setTimeout(e,100)};e()})}},786:(t,e,a)=>{a.d(e,{Dl:()=>p,H:()=>f,KO:()=>x,dz:()=>s,getUserFolders:()=>r,mT:()=>g,moveProjectToFolder:()=>v,removeProjectFromFolder:()=>w,sE:()=>c,tq:()=>u,updateFolder:()=>l,vV:()=>d,xu:()=>m});var n=a(626),i=a(3283);async function o(t){let e=(await (0,n.yv)()).db.collection("folders");return(await e.find()).filter(e=>e.creator_id===t).sort((t,e)=>{let a=t.last_accessed_at||t.created_at;return new Date(e.last_accessed_at||e.created_at).getTime()-new Date(a).getTime()})}async function r(t){let e=await (0,n.yv)(),a=await o(t),i=e.db.collection("folder_access"),r=(await i.find()).filter(e=>e.user_email===t),s=e.db.collection("folders"),d=r.map(async t=>{try{return await s.findById(t.folder_id)}catch(t){return null}});return Array.from(new Map([...a,...(await Promise.all(d)).filter(Boolean)].map(t=>[t.id,t])).values()).sort((t,e)=>{let a=t.last_accessed_at||t.created_at;return new Date(e.last_accessed_at||e.created_at).getTime()-new Date(a).getTime()})}async function s(t){let e=(await (0,n.yv)()).db.collection("folders");try{return await e.findById(t)}catch(e){return console.error("Folder not found:",t,e),null}}async function d(t){let e=(await (0,n.yv)()).db.collection("folders"),a=t.position;return void 0===a&&(a=(await o(t.creator_id)).length),await e.create({name:t.name,creator_id:t.creator_id,position:a})}async function l(t,e){let a=(await (0,n.yv)()).db.collection("folders");return await a.update(t,e),await a.findById(t)}async function c(t){let e=await (0,n.yv)(),a=await g(t);await Promise.all(a.map(t=>(0,i.xx)(t.id)));let o=e.db.collection("folders");await o.delete(t);let r=e.db.collection("folder_access"),s=(await r.find()).filter(e=>e.folder_id===t);await Promise.all(s.map(t=>r.delete(t.id)))}async function u(t,e){let a=await s(t);return!!a&&(a.creator_id===e||(await p(t)).some(t=>t.user_email===e&&"editor"===t.role))}async function f(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"editor",i=(await (0,n.yv)()).db.collection("folder_access"),o=(await i.find()).find(a=>a.folder_id===t&&a.user_email===e);o?await i.update(o.id,{role:a}):await i.create({folder_id:t,user_email:e,role:a})}async function m(t,e){let a=(await (0,n.yv)()).db.collection("folder_access"),i=(await a.find()).find(a=>a.folder_id===t&&a.user_email===e);i&&await a.delete(i.id)}async function p(t){let e=(await (0,n.yv)()).db.collection("folder_access");return(await e.find()).filter(e=>e.folder_id===t)}async function g(t){let e=(await (0,n.yv)()).db.collection("projects");return(await e.find()).filter(e=>e.folder_id===t).sort((t,e)=>{let a=t.last_accessed_at||t.created_at;return new Date(e.last_accessed_at||e.created_at).getTime()-new Date(a).getTime()})}async function v(t,e){let a=(await (0,n.yv)()).db.collection("projects");await a.update(t,{folder_id:e})}async function w(t){let e=(await (0,n.yv)()).db.collection("projects");await e.update(t,{folder_id:null})}async function x(t){return(await g(t)).length}},3173:(t,e,a)=>{a.d(e,{p:()=>o});var n=a(8045);a(5177);var i=a(6816);function o(t){let{className:e,type:a,...o}=t;return(0,n.jsx)("input",{type:a,"data-slot":"input",className:(0,i.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...o})}},3283:(t,e,a)=>{a.d(e,{Br:()=>b,CM:()=>x,Db:()=>f,Dg:()=>v,E0:()=>h,JQ:()=>i,L1:()=>o,Qg:()=>_,X5:()=>l,X7:()=>j,XA:()=>u,a3:()=>c,ct:()=>g,eP:()=>w,gA:()=>r,oZ:()=>m,updateProject:()=>s,wp:()=>y,xx:()=>d,yg:()=>p});var n=a(626);async function i(t){let e=(await (0,n.yv)()).db.collection("projects"),a=await e.find();return t&&(a=a.filter(e=>e.creator_id===t)),a.sort((t,e)=>{let a=t.last_accessed_at||t.created_at;return new Date(e.last_accessed_at||e.created_at).getTime()-new Date(a).getTime()})}async function o(t){let e=(await (0,n.yv)()).db.collection("projects");return(await e.find()).find(e=>e.share_token===t)||null}async function r(t){let e=(await (0,n.yv)()).db.collection("projects"),a={name:t.name,creator_id:t.creator_id,share_token:t.share_token,folder_id:t.folder_id||null,settings:t.settings||{default_columns:3,allow_viewer_control:!0,background_color:"#ffffff"}},i=await e.create(a);return await c({project_id:i.id,name:"Page 01",position:0}),i}async function s(t,e){let a=(await (0,n.yv)()).db.collection("projects");return await a.update(t,e),await a.findById(t)}async function d(t){let e=await (0,n.yv)(),a=await p(t);await Promise.all(a.map(t=>x(t.id)));let i=await l(t);await Promise.all(i.map(t=>f(t.id)));let o=e.db.collection("projects");await o.delete(t)}async function l(t){let e=(await (0,n.yv)()).db.collection("pages");return(await e.find()).filter(e=>e.project_id===t).sort((t,e)=>t.position-e.position)}async function c(t){let e=(await (0,n.yv)()).db.collection("pages");return await e.create(t)}async function u(t,e){let a=(await (0,n.yv)()).db.collection("pages");return await a.update(t,e),await a.findById(t)}async function f(t){let e=await (0,n.yv)(),a=await g(t);await Promise.all(a.map(t=>x(t.id)));let i=e.db.collection("pages");await i.delete(t)}async function m(t){let e=(await (0,n.yv)()).db.collection("pages");await Promise.all(t.map(t=>{let{id:a,position:n}=t;return e.update(a,{position:n})}))}async function p(t){let e=(await (0,n.yv)()).db.collection("artifacts");return(await e.find()).filter(e=>e.project_id===t).sort((t,e)=>t.position-e.position)}async function g(t){let e=(await (0,n.yv)()).db.collection("artifacts");return(await e.find()).filter(e=>e.page_id===t).sort((t,e)=>t.position-e.position)}async function v(t){let e=(await (0,n.yv)()).db.collection("artifacts"),a={project_id:t.project_id,page_id:t.page_id,type:t.type,source_url:t.source_url,file_path:t.file_path||null,name:t.name,position:t.position,metadata:t.metadata||{}};return await e.create(a)}async function w(t,e){let a=(await (0,n.yv)()).db.collection("artifacts");return await a.update(t,e),await a.findById(t)}async function x(t){let e=(await (0,n.yv)()).db.collection("artifacts");await e.delete(t)}async function b(t){let e=(await (0,n.yv)()).db.collection("artifacts");await Promise.all(t.map(t=>{let{id:a,position:n}=t;return e.update(a,{position:n})}))}async function y(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"editor",i=(await (0,n.yv)()).db.collection("project_access"),o=(await i.find()).find(a=>a.project_id===t&&a.user_email===e);o?await i.update(o.id,{role:a}):await i.create({project_id:t,user_email:e,role:a})}async function h(t,e){let a=(await (0,n.yv)()).db.collection("project_access"),i=(await a.find()).find(a=>a.project_id===t&&a.user_email===e);i&&await a.delete(i.id)}async function _(t){let e=(await (0,n.yv)()).db.collection("project_access");return(await e.find()).filter(e=>e.project_id===t)}async function j(t,e,a){let i=(await (0,n.yv)()).db.collection(t),o=(await i.find()).filter(t=>t[a]===e);return 0===o.length?0:Math.max(...o.map(t=>t.position||0))+1}},6198:(t,e,a)=>{a.d(e,{A:()=>d,AuthProvider:()=>s});var n=a(8045),i=a(5177),o=a(626);let r=(0,i.createContext)(void 0);function s(t){let{children:e}=t,[a,s]=(0,i.useState)(null),[d,l]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{let t=!0;return async function(){try{let e=await (0,o.yv)(),a=await e.id.waitForUser();console.log("Quick user loaded:",a),t&&(s({email:a.email,fullName:a.fullName,firstName:a.firstName,slackHandle:a.slackHandle,slackId:a.slackId,slackImageUrl:a.slackImageUrl,title:a.title,github:a.github}),l(!1))}catch(e){console.error("Failed to load Quick user:",e),t&&l(!1)}}(),()=>{t=!1}},[]),(0,n.jsx)(r.Provider,{value:{user:a,loading:d,isAuthenticated:!!a,signIn:async()=>{window.location.reload()},signOut:async()=>{console.warn("Sign out is handled by Quick platform - redirect to logout if needed")}},children:e})}function d(){let t=(0,i.useContext)(r);if(!t)throw Error("useAuth must be used within an AuthProvider");return t}},6436:(t,e,a)=>{a.d(e,{Fj:()=>l,Ip:()=>f,Pd:()=>c,Rc:()=>d,es:()=>u,kt:()=>m,tz:()=>s});var n=a(8045);a(5177);var i=a(3726),o=a(6243),r=a(6816);function s(t){let{...e}=t;return(0,n.jsx)(i.bL,{"data-slot":"context-menu",...e})}function d(t){let{...e}=t;return(0,n.jsx)(i.l9,{"data-slot":"context-menu-trigger",...e})}function l(t){let{...e}=t;return(0,n.jsx)(i.Pb,{"data-slot":"context-menu-sub",...e})}function c(t){let{className:e,inset:a,children:s,...d}=t;return(0,n.jsxs)(i.ZP,{"data-slot":"context-menu-sub-trigger","data-inset":a,className:(0,r.cn)("focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex cursor-default items-center rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...d,children:[s,(0,n.jsx)(o.A,{className:"ml-auto"})]})}function u(t){let{className:e,...a}=t;return(0,n.jsx)(i.G5,{"data-slot":"context-menu-sub-content",className:(0,r.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg",e),...a})}function f(t){let{className:e,...a}=t;return(0,n.jsx)(i.ZL,{children:(0,n.jsx)(i.UC,{"data-slot":"context-menu-content",className:(0,r.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...a})})}function m(t){let{className:e,inset:a,variant:o="default",...s}=t;return(0,n.jsx)(i.q7,{"data-slot":"context-menu-item","data-inset":a,"data-variant":o,className:(0,r.cn)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...s})}},6796:(t,e,a)=>{a.d(e,{SQ:()=>d,_2:()=>l,rI:()=>r,ty:()=>s});var n=a(8045);a(5177);var i=a(7532),o=a(6816);function r(t){let{...e}=t;return(0,n.jsx)(i.bL,{"data-slot":"dropdown-menu",...e})}function s(t){let{...e}=t;return(0,n.jsx)(i.l9,{"data-slot":"dropdown-menu-trigger",...e})}function d(t){let{className:e,sideOffset:a=4,...r}=t;return(0,n.jsx)(i.ZL,{children:(0,n.jsx)(i.UC,{"data-slot":"dropdown-menu-content",sideOffset:a,className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...r})})}function l(t){let{className:e,inset:a,variant:r="default",...s}=t;return(0,n.jsx)(i.q7,{"data-slot":"dropdown-menu-item","data-inset":a,"data-variant":r,className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...s})}},6816:(t,e,a)=>{a.d(e,{cn:()=>o});var n=a(2207),i=a(1251);function o(){for(var t=arguments.length,e=Array(t),a=0;a<t;a++)e[a]=arguments[a];return(0,i.QP)((0,n.$)(e))}},7023:(t,e,a)=>{a.d(e,{Cf:()=>u,Es:()=>m,L3:()=>p,c7:()=>f,lG:()=>s,rr:()=>g,zM:()=>d});var n=a(8045);a(5177);var i=a(1868),o=a(8227),r=a(6816);function s(t){let{...e}=t;return(0,n.jsx)(i.bL,{"data-slot":"dialog",...e})}function d(t){let{...e}=t;return(0,n.jsx)(i.l9,{"data-slot":"dialog-trigger",...e})}function l(t){let{...e}=t;return(0,n.jsx)(i.ZL,{"data-slot":"dialog-portal",...e})}function c(t){let{className:e,...a}=t;return(0,n.jsx)(i.hJ,{"data-slot":"dialog-overlay",className:(0,r.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...a})}function u(t){let{className:e,children:a,showCloseButton:s=!0,...d}=t;return(0,n.jsxs)(l,{"data-slot":"dialog-portal",children:[(0,n.jsx)(c,{}),(0,n.jsxs)(i.UC,{"data-slot":"dialog-content",className:(0,r.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...d,children:[a,s&&(0,n.jsxs)(i.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,n.jsx)(o.A,{}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function f(t){let{className:e,...a}=t;return(0,n.jsx)("div",{"data-slot":"dialog-header",className:(0,r.cn)("flex flex-col gap-2 text-center sm:text-left",e),...a})}function m(t){let{className:e,...a}=t;return(0,n.jsx)("div",{"data-slot":"dialog-footer",className:(0,r.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...a})}function p(t){let{className:e,...a}=t;return(0,n.jsx)(i.hE,{"data-slot":"dialog-title",className:(0,r.cn)("text-lg leading-none font-semibold",e),...a})}function g(t){let{className:e,...a}=t;return(0,n.jsx)(i.VY,{"data-slot":"dialog-description",className:(0,r.cn)("text-muted-foreground text-sm",e),...a})}},8533:(t,e,a)=>{a.d(e,{A:()=>r});var n=a(8045),i=a(4513),o=a(5177);function r(t){let{children:e,isLoading:a=!1}=t,[r,s]=(0,o.useState)(!1);(0,o.useEffect)(()=>{a||s(!0)},[a]);let d=window.matchMedia("(prefers-reduced-motion: reduce)").matches;return a?null:(0,n.jsx)(i.P.div,{initial:{opacity:0},animate:{opacity:+!!r},exit:{opacity:0},transition:{duration:.5*!d,ease:"easeInOut"},style:{width:"100%",height:"100%"},children:e})}},9155:(t,e,a)=>{a.d(e,{$:()=>d,r:()=>s});var n=a(8045);a(5177);var i=a(3725),o=a(1399),r=a(6816);let s=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive cursor-pointer",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function d(t){let{className:e,variant:a,size:o,asChild:d=!1,...l}=t,c=d?i.DX:"button";return(0,n.jsx)(c,{"data-slot":"button",className:(0,r.cn)(s({variant:a,size:o,className:e})),...l})}},9657:(t,e,a)=>{a.d(e,{A:()=>s});var n=a(8045),i=a(5177),o=a(3173),r=a(9155);function s(t){let{onAdd:e,disabled:a}=t,[s,d]=(0,i.useState)(""),[l,c]=(0,i.useState)(!1),u=s?"".concat(s,"@shopify.com"):"";function f(t){return/^[a-z0-9.-]+$/.test(t)&&t.length>0}async function m(){if(s.trim()&&f(s)){c(!0);try{await e(u),d("")}catch(t){}finally{c(!1)}}}return(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)("div",{className:"flex-1 flex items-center border rounded-md overflow-hidden focus-within:ring-2 focus-within:ring-ring",children:[(0,n.jsx)(o.p,{placeholder:"firstname.lastname",value:s,onChange:t=>d(t.target.value.toLowerCase().replace(/[^a-z0-9.-]/g,"")),onKeyDown:function(t){"Enter"===t.key?(t.preventDefault(),m()):"Escape"===t.key&&d("")},disabled:a||l,className:"border-0 focus-visible:ring-0 shadow-none",autoComplete:"off"}),(0,n.jsx)("div",{className:"px-3 py-2 text-sm text-muted-foreground bg-muted border-l select-none",children:"@shopify.com"})]}),(0,n.jsx)(r.$,{onClick:m,disabled:!s.trim()||!f(s)||a||l,size:"sm",children:l?"Adding...":"Add"})]}),s&&f(s)&&(0,n.jsxs)("div",{className:"text-xs text-muted-foreground flex items-center gap-2",children:[(0,n.jsxs)("span",{children:["Press ",(0,n.jsx)("kbd",{className:"px-1.5 py-0.5 bg-muted rounded font-mono",children:"Enter"})," to add:"]}),(0,n.jsx)("span",{className:"font-medium",children:u})]}),s&&!f(s)&&(0,n.jsx)("div",{className:"text-xs text-red-600",children:"Only lowercase letters, numbers, dots, and hyphens allowed"})]})}}}]);