"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[115],{1266:(e,a,t)=>{t.d(a,{OG:()=>l,di:()=>r,y8:()=>s});let s={iphone15pro:{label:"iPhone 15 Pro",width:393,height:852},ipadAir:{label:"iPad Air",width:820,height:1180},laptop:{label:"Laptop",width:1512,height:900}},r="laptop";function l(e){let a=e?s[e]:s[r];return{width:a.width,height:a.height}}},1905:(e,a,t)=>{t.d(a,{C:()=>n});var s=t(3842),r=t(5177),l=t(3283);async function i(e){return await (0,l.ct)(e)}function n(e,a){let{data:t=[],error:n,isLoading:o,mutate:c}=(0,s.Ay)(a?"page-artifacts-".concat(a):null,()=>a?i(a):[],{revalidateOnFocus:!1,dedupingInterval:3e5,keepPreviousData:!0}),d=(0,r.useCallback)(async t=>{if(!e||!a)return null;try{let s=await (0,l.X7)("artifacts",a,"page_id"),r=await (0,l.Dg)({project_id:e,page_id:a,type:t.type,source_url:t.source_url,file_path:t.file_path||void 0,name:t.name||"Untitled",position:s,metadata:t.metadata||{}});return await c(),r}catch(e){throw console.error("Failed to create artifact:",e),e}},[e,a,c]),m=(0,r.useCallback)(async t=>{if(e&&a){c(t,!1);try{let e=t.map((e,a)=>({id:e.id,position:a}));await (0,l.Br)(e),await c()}catch(e){throw await c(),console.error("Failed to reorder artifacts:",e),e}}},[e,a,c]);return{artifacts:t,isLoading:o,error:n,createArtifact:d,reorderArtifacts:m,updateArtifact:(0,r.useCallback)(async(a,t)=>{if(!e)return null;try{let e=await (0,l.eP)(a,t);return await c(),e}catch(e){throw console.error("Failed to update artifact:",e),e}},[e,c]),deleteArtifact:(0,r.useCallback)(async a=>{if(e)try{await (0,l.CM)(a),await c()}catch(e){throw console.error("Failed to delete artifact:",e),e}},[e,c]),refetch:c}}},2971:(e,a,t)=>{t.d(a,{d:()=>i});var s=t(8045);t(5177);var r=t(7904),l=t(6816);function i(e){let{className:a,...t}=e;return(0,s.jsx)(r.bL,{"data-slot":"switch",className:(0,l.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...t,children:(0,s.jsx)(r.zi,{"data-slot":"switch-thumb",className:(0,l.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}},6115:(e,a,t)=>{t.d(a,{A:()=>X});var s=t(8045),r=t(5177),l=t(4104),i=t(4988),n=t(2501),o=t(5860),c=t(9069),d=t(5091),m=t(9808),h=t(9155),u=t(9859),x=t(6816);function p(e){let{className:a,defaultValue:t,value:l,min:i=0,max:n=100,...o}=e,c=r.useMemo(()=>Array.isArray(l)?l:Array.isArray(t)?t:[i,n],[l,t,i,n]);return(0,s.jsxs)(u.bL,{"data-slot":"slider",defaultValue:t,value:l,min:i,max:n,className:(0,x.cn)("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",a),...o,children:[(0,s.jsx)(u.CC,{"data-slot":"slider-track",className:(0,x.cn)("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:(0,s.jsx)(u.Q6,{"data-slot":"slider-range",className:(0,x.cn)("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:c.length},(e,a)=>(0,s.jsx)(u.zi,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},a))]})}var f=t(6796),g=t(3173),j=t(7023),v=t(1266),b=t(1905),w=t(6835),y=t(8998),N=t(7651);function k(e){let{projectId:a,pageId:t,onAdded:l}=e,[i,n]=(0,r.useState)(!1),[o,d]=(0,r.useState)(""),[m,u]=(0,r.useState)([]),[x,p]=(0,r.useState)({uploading:!1,totalFiles:0,completedFiles:0,currentProgress:0}),[f,k]=(0,r.useState)(null),[C,F]=(0,r.useState)(v.di),{createArtifact:S}=(0,b.C)(a,t);function A(){d(""),u([]),k(null),F(v.di),p({uploading:!1,totalFiles:0,completedFiles:0,currentProgress:0})}async function R(){k(null);try{if(m.length){for(let e of m){let a=(0,y.validateFile)(e,{maxSizeMB:50});if(!a.valid){k(a.error||"File too large"),N.oR.error(a.error||"File too large");return}}p({uploading:!0,totalFiles:m.length,completedFiles:0,currentProgress:0});let e=0;for(let a of m){let t=await (0,y.QM)(a,a=>{let t=a.percentage,s=Math.round((100*e+t)/m.length);p(e=>({...e,currentProgress:s}))}),s=(0,y.lu)(t.mimeType),r="video"===s?{hideUI:!0,loop:!0,muted:!0}:{},l=(0,w.Rr)(s,t.fullUrl,a);await S({type:s,source_url:t.fullUrl,file_path:t.url,name:l,metadata:r}),e++,p(a=>({...a,completedFiles:e,currentProgress:Math.round(e/m.length*100)}))}}if(!m.length&&o){p({uploading:!0,totalFiles:1,completedFiles:0,currentProgress:50});let e=(0,v.OG)(C),a=(0,w.Rr)("url",o);await S({type:"url",source_url:o,name:a,metadata:{viewport:C,width:e.width,height:e.height}}),p(e=>({...e,completedFiles:1,currentProgress:100}))}m.length?N.oR.success("Successfully uploaded ".concat(m.length," file").concat(m.length>1?"s":"")):o&&N.oR.success("Successfully added URL artifact"),n(!1),A(),null==l||l()}catch(e){k(e.message),N.oR.error(e.message||"Upload failed. Please try again."),p({uploading:!1,totalFiles:0,completedFiles:0,currentProgress:0})}}return(0,s.jsxs)(j.lG,{open:i,onOpenChange:e=>{n(e),e||A()},children:[(0,s.jsx)(j.zM,{asChild:!0,children:(0,s.jsx)(h.$,{variant:"outline",size:"icon","aria-label":"Add artifact",children:(0,s.jsx)(c.A,{className:"h-4 w-4"})})}),(0,s.jsxs)(j.Cf,{className:"w-full max-w-2xl text-white border-white/10",style:{backgroundColor:"var(--color-background-secondary)"},showCloseButton:!x.uploading,children:[(0,s.jsx)(j.c7,{children:(0,s.jsx)(j.L3,{className:"text-white",children:"Add Artifact"})}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("p",{className:"text-sm text-white/70",children:"Upload files"}),(0,s.jsxs)("label",{className:"flex flex-col items-center justify-center gap-3 rounded-2xl border border-dashed border-white/20 bg-white/5 py-12 cursor-pointer transition hover:border-white/40",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:"Browse files"}),(0,s.jsx)("span",{className:"text-xs text-white/60",children:"Images or videos up to 50MB"}),(0,s.jsx)("input",{type:"file",multiple:!0,accept:"image/*,video/*",className:"hidden",onChange:function(e){u(Array.from(e.target.files||[]))}})]}),m.length>0&&(0,s.jsxs)("div",{className:"text-xs text-white/60",children:[m.length," file",m.length>1?"s":""," selected"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 text-sm text-white/40",children:[(0,s.jsx)("div",{className:"flex-1 h-px bg-white/15"}),"or",(0,s.jsx)("div",{className:"flex-1 h-px bg-white/15"})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm text-white/70",children:"Embed via URL"}),(0,s.jsx)(g.p,{value:o,onChange:e=>d(e.target.value),placeholder:"https://example.com/artifact",className:"w-full bg-white/5 border-white/15 text-white placeholder:text-white/60 focus:border-white/30 focus:ring-white/20"})]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 text-xs text-white/70",children:Object.entries(v.y8).map(e=>{let[a,t]=e;return(0,s.jsx)("button",{type:"button",onClick:()=>F(a),className:"rounded-full px-3 py-1 border transition cursor-pointer ".concat(C===a?"border-white/40 bg-white/20 text-white":"border-white/15 bg-white/5 text-white/70 hover:border-white/30"),children:t.label},a)})})]}),x.uploading&&(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"text-center text-sm text-white/80",children:["Uploading",x.totalFiles>1?" ".concat(x.completedFiles+1," of ").concat(x.totalFiles):"","..."]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"w-full bg-white/20 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-white h-2 rounded-full transition-all duration-300 ease-out",style:{width:"".concat(x.currentProgress,"%")}})}),(0,s.jsxs)("div",{className:"text-center text-xs text-white/60",children:[x.currentProgress,"%"]})]})]}),f&&(0,s.jsx)("div",{className:"text-sm text-red-400",children:f})]}),(0,s.jsxs)(j.Es,{children:[(0,s.jsx)(h.$,{variant:"ghost",onClick:()=>{n(!1),A()},disabled:x.uploading,className:"text-white hover:bg-white/10",children:"Cancel"}),(0,s.jsx)(h.$,{onClick:R,disabled:x.uploading||!m.length&&!o,className:"bg-white text-black hover:bg-white/90",children:x.uploading?"Uploading…":"Add"})]})]})]})}var C=t(6655),F=t(3659),S=t(9005),A=t(8227),R=t(3283);function P(e){let{initialValue:a,projectId:l,onUpdated:i,isReadOnly:n=!1,isFolder:o=!1,folders:c=[],currentFolderId:d=null,onMoveToFolder:m,onRemoveFromFolder:u}=e,[x,p]=(0,r.useState)(a),[j,v]=(0,r.useState)(!1),[b,w]=(0,r.useState)(!1);async function y(e){if(!l||!e.trim())return void p(a);w(!0);try{if(o){let{updateFolder:a}=await Promise.resolve().then(t.bind(t,786));await a(l,{name:e.trim()}),null==i||i(e.trim()),N.oR.success("Folder renamed")}else await (0,R.updateProject)(l,{name:e.trim()}),null==i||i(e.trim()),N.oR.success("Project name updated")}catch(e){console.error("Failed to update ".concat(o?"folder":"project"," name:"),e),N.oR.error("Failed to update ".concat(o?"folder":"project"," name")),p(a)}finally{w(!1),v(!1)}}(0,r.useEffect)(()=>{p(a)},[a]);let k=c.filter(e=>e.id!==d),P=!n&&m&&(k.length>0||d);return n?(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)("span",{className:"text-white font-semibold text-base px-2 py-1",children:x||"Untitled Project"})}):(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[j?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(g.p,{autoFocus:!0,value:x,onChange:e=>p(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),y(x)),"Escape"===e.key&&(p(a),v(!1))},className:"bg-white/10 border-white/20 text-white focus:bg-white/20 focus:border-white/40 focus:ring-white/30 min-w-[200px]",disabled:b}),(0,s.jsx)(h.$,{variant:"ghost",size:"icon",onClick:()=>y(x),disabled:b,className:"h-8 w-8 text-white hover:bg-white/10","aria-label":"Save project name",children:(0,s.jsx)(C.A,{className:"h-4 w-4"})})]}):(0,s.jsx)("button",{type:"button",onClick:()=>v(!0),className:"text-left text-white font-semibold text-base px-2 py-1 rounded hover:bg-white/10 transition-colors cursor-pointer focus:outline-none focus:ring-2 focus:ring-white/30",children:(0,s.jsx)("span",{children:x||"Untitled Project"})}),b&&(0,s.jsx)("span",{className:"text-xs text-white/60 ml-2",children:"Saving…"}),P&&(0,s.jsxs)(f.rI,{children:[(0,s.jsx)(f.ty,{asChild:!0,children:(0,s.jsx)(h.$,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-white/60 hover:text-white hover:bg-white/10",children:(0,s.jsx)(F.A,{className:"h-4 w-4"})})}),(0,s.jsxs)(f.SQ,{align:"start",children:[k.length>0&&k.map(e=>(0,s.jsxs)(f._2,{onClick:()=>null==m?void 0:m(e.id),className:"flex items-center gap-2",children:[(0,s.jsx)(S.A,{className:"h-4 w-4"}),"Move to ",e.name]},e.id)),d&&u&&(0,s.jsxs)(s.Fragment,{children:[k.length>0&&(0,s.jsx)("div",{className:"h-px bg-border my-1"}),(0,s.jsxs)(f._2,{onClick:u,className:"flex items-center gap-2",children:[(0,s.jsx)(A.A,{className:"h-4 w-4"}),"Remove from Folder"]})]})]})]})]})}var z=t(3444);let U=z.bL,_=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(z.B8,{ref:a,className:(0,x.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",t),...r})});_.displayName=z.B8.displayName;let I=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(z.l9,{ref:a,className:(0,x.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",t),...r})});I.displayName=z.l9.displayName;let O=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(z.UC,{ref:a,className:(0,x.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r})});O.displayName=z.UC.displayName;var T=t(3508),E=t(6560),M=t(603),$=t(9657);function L(e){let{projectId:a,projectName:t,creatorEmail:l,shareToken:i}=e,[n,o]=(0,r.useState)([]),[c,d]=(0,r.useState)(!0),[m,u]=(0,r.useState)(!1),x="https://artifact.quick.shopify.io/p?token=".concat(i);async function p(e){if(e===l)return void N.oR.error("You're already the owner");if(n.some(a=>a.user_email===e))return void N.oR.error("This person already has access");try{await (0,R.wp)(a,e,"editor");let t=await (0,R.Qg)(a);o(t),N.oR.success("Added ".concat(e," as collaborator"))}catch(e){throw console.error("Failed to add collaborator:",e),N.oR.error("Failed to add collaborator"),e}}async function f(e){try{await (0,R.E0)(a,e),o(a=>a.filter(a=>a.user_email!==e)),N.oR.success("Removed ".concat(e))}catch(e){console.error("Failed to remove collaborator:",e),N.oR.error("Failed to remove collaborator")}}async function j(){try{await navigator.clipboard.writeText(x),u(!0),N.oR.success("Link copied!"),setTimeout(()=>u(!1),2e3)}catch(e){N.oR.error("Failed to copy link")}}return((0,r.useEffect)(()=>{!async function(){try{let e=await (0,R.Qg)(a);o(e)}catch(e){console.error("Failed to load collaborators:",e),N.oR.error("Failed to load collaborators")}finally{d(!1)}}()},[a]),c)?(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Loading..."}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold",children:"Who has access"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg border",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(E.A,{className:"h-4 w-4 text-yellow-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:l}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Owner"})]})]})}),n.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border hover:bg-muted/50 transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(M.A,{className:"h-4 w-4 text-green-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:e.user_email}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Can edit"})]})]}),(0,s.jsx)(h.$,{variant:"ghost",size:"sm",onClick:()=>f(e.user_email),className:"text-muted-foreground hover:text-destructive",children:(0,s.jsx)(A.A,{className:"h-4 w-4"})})]},e.id)),0===n.length&&(0,s.jsx)("div",{className:"text-sm text-muted-foreground text-center py-6 border rounded-lg border-dashed",children:"No collaborators yet. Add people below to let them edit this project."})]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold",children:"Add people"}),(0,s.jsx)($.A,{onAdd:p,disabled:c}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Type a Shopify username and press Enter to add multiple people quickly."})]}),n.length>0&&(0,s.jsx)("div",{className:"border-t pt-4 space-y-3",children:(0,s.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-900 rounded-lg p-4 space-y-3",children:[(0,s.jsx)("div",{className:"flex items-start gap-2",children:(0,s.jsxs)("div",{className:"text-sm text-blue-900 dark:text-blue-100",children:[(0,s.jsx)("p",{className:"font-semibold mb-1",children:"\uD83D\uDCE4 Share the link"}),(0,s.jsx)("p",{className:"text-xs",children:"Send this link to your collaborators so they can access the project:"})]})}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(g.p,{value:x,readOnly:!0,className:"font-mono text-xs bg-white dark:bg-gray-950",onClick:e=>e.currentTarget.select()}),(0,s.jsx)(h.$,{onClick:j,variant:m?"default":"outline",size:"sm",className:"shrink-0",children:m?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C.A,{className:"h-4 w-4 mr-1"}),"Copied"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(T.A,{className:"h-4 w-4 mr-1"}),"Copy"]})})]})]})})]})}function B(e){let{projectId:a,projectName:t,shareToken:l,creatorEmail:i,isCreator:n,isOpen:o,onClose:c}=e,[d,m]=(0,r.useState)(!1),u="https://artifact.quick.shopify.io/p?token=".concat(l);async function x(){try{await navigator.clipboard.writeText(u),m(!0),N.oR.success("Link copied to clipboard!"),setTimeout(()=>m(!1),2e3)}catch(e){console.error("Failed to copy:",e),N.oR.error("Failed to copy link. Please copy manually.")}}return(0,s.jsx)(j.lG,{open:o,onOpenChange:c,children:(0,s.jsxs)(j.Cf,{className:"sm:max-w-2xl",children:[(0,s.jsxs)(j.c7,{children:[(0,s.jsxs)(j.L3,{children:["Share “",t,"”"]}),(0,s.jsx)(j.rr,{children:"Manage who can view and edit this project"})]}),(0,s.jsxs)(U,{defaultValue:"link",className:"w-full",children:[(0,s.jsxs)(_,{className:"grid w-full grid-cols-2",children:[(0,s.jsx)(I,{value:"link",children:"Share Link"}),n&&(0,s.jsx)(I,{value:"collaborators",children:"Collaborators"})]}),(0,s.jsx)(O,{value:"link",className:"space-y-4",children:(0,s.jsxs)("div",{className:"space-y-4 pt-2",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(g.p,{value:u,readOnly:!0,className:"font-mono text-sm",onClick:e=>e.currentTarget.select()}),(0,s.jsx)(h.$,{onClick:x,variant:d?"default":"outline",className:"shrink-0",children:d?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C.A,{className:"h-4 w-4 mr-2"}),"Copied!"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(T.A,{className:"h-4 w-4 mr-2"}),"Copy"]})})]}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground bg-muted p-3 rounded-lg",children:(0,s.jsxs)("p",{children:["Anyone at Shopify can view this project with the link above.",n?" Add collaborators in the Collaborators tab to let specific people edit.":" Only the owner can make changes."]})})]})}),n&&(0,s.jsx)(O,{value:"collaborators",className:"space-y-4 pt-2",children:(0,s.jsx)(L,{projectId:a,projectName:t,creatorEmail:i,shareToken:l})})]})]})})}var D=t(4922);function Q(){return(0,s.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded-md border border-blue-500/30 bg-blue-500/10 text-blue-600",children:[(0,s.jsx)(D.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"View only"})]})}function V(e){let{creatorEmail:a}=e;return(0,s.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded-md border border-green-500/30 bg-green-500/10 text-green-600",title:"You can edit this project (owned by ".concat(a,")"),children:[(0,s.jsx)(M.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"Collaborator"})]})}var G=t(2971),W=t(6198);function q(){let{user:e}=(0,W.A)();if(!e)return(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center text-sm font-medium",children:"?"});let a=e.fullName||e.email,t=a.split(" ").map(e=>e.charAt(0).toUpperCase()).join("").slice(0,2);return e.slackImageUrl?(0,s.jsx)("img",{src:e.slackImageUrl,alt:a,className:"w-8 h-8 rounded-full",title:a}):(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-sm font-medium",title:a,children:t})}var J=t(5070);function K(e){var a,t,u;let{onBackToHome:x,onToggleSidebar:g,sidebarOpen:j,projectId:v,projectName:b,shareToken:w,creatorEmail:y,isCreator:N=!1,isCollaborator:C=!1,isReadOnly:F=!1,currentFolderId:S,folders:A=[],onProjectNameUpdate:R,onMoveToFolder:z,onRemoveFromFolder:U,onArtifactAdded:_,folderId:I,folderName:O,onFolderNameUpdate:T,onFolderShare:E,onFolderRename:M,onFolderDelete:$,onNewProject:L,currentPageId:D,columns:K=3,onColumnsChange:Y,showColumnControls:H=!0,fitMode:X=!1,onFitModeChange:Z,mode:ee}=e,[ea,et]=(0,r.useState)(!1),{user:es,signIn:er,signOut:el,loading:ei}=(0,W.A)(),en=(0,J.useRouter)(),eo=async()=>{await er()},ec=async()=>{await el(),en.push("/auth/login")};return(0,s.jsx)("header",{className:"bg-[var(--color-background-primary)] border-b border-[var(--color-border-primary)] relative z-10",style:{height:"var(--header-height)"},children:(0,s.jsxs)("div",{className:"flex items-center justify-between h-full px-8",children:[(0,s.jsx)("div",{className:"flex items-center gap-3 w-full max-w-[var(--section-width)]",children:"homepage"===ee?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("img",{src:"/favicons/icon-256.png",alt:"Artifact",className:"w-8 h-8",style:{imageRendering:"crisp-edges"}}),(0,s.jsx)("h1",{className:"text-lg font-semibold text-[var(--color-text-primary)]",children:"Artifact"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.$,{variant:"outline",size:"icon",onClick:x,"aria-label":"Back",children:(0,s.jsx)(l.A,{className:"h-4 w-4"})}),g&&(0,s.jsx)(h.$,{variant:"outline",size:"icon",onClick:g,"aria-label":j?"Close sidebar":"Open sidebar",children:j?(0,s.jsx)(i.A,{className:"h-4 w-4"}):(0,s.jsx)(n.A,{className:"h-4 w-4"})}),v&&D&&_&&(0,s.jsx)(k,{projectId:v,pageId:D,onAdded:_}),H&&Y&&(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground font-medium min-w-[12px]",children:K}),(0,s.jsx)("div",{className:"w-24",children:(0,s.jsx)(p,{min:1,max:8,value:[K],onValueChange:e=>{var a;return Y(null!=(a=e[0])?a:K)},className:"w-full"})}),1===K&&Z&&(0,s.jsxs)("div",{className:"flex items-center gap-2 ml-2",children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground font-medium",children:"Fit"}),(0,s.jsx)(G.d,{checked:X,onCheckedChange:Z})]})]})})]})}),"canvas"===ee&&v&&(0,s.jsx)("div",{className:"flex items-center justify-center w-full max-w-[var(--section-width)]",children:(0,s.jsx)(P,{initialValue:b||"Untitled Project",projectId:v,onUpdated:R,isReadOnly:!R,folders:A,currentFolderId:S,onMoveToFolder:z,onRemoveFromFolder:U})}),"folder"===ee&&I&&(0,s.jsx)("div",{className:"flex items-center justify-center w-full max-w-[var(--section-width)]",children:(0,s.jsx)(P,{initialValue:O||"Untitled Folder",projectId:I,onUpdated:T,isReadOnly:!T,isFolder:!0})}),(0,s.jsx)("div",{className:"flex items-center justify-end gap-3 w-full max-w-[var(--section-width)]",children:"folder"===ee?(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[E&&(0,s.jsxs)(h.$,{variant:"outline",className:"gap-2",onClick:E,children:[(0,s.jsx)(o.A,{className:"h-4 w-4"}),"Share"]}),L&&(0,s.jsxs)(h.$,{className:"gap-2",onClick:L,children:[(0,s.jsx)(c.A,{className:"h-4 w-4"}),"New Project"]}),(M||$)&&(0,s.jsxs)(f.rI,{children:[(0,s.jsx)(f.ty,{asChild:!0,children:(0,s.jsx)(h.$,{variant:"outline",size:"icon",children:(0,s.jsx)(d.A,{className:"h-4 w-4"})})}),(0,s.jsxs)(f.SQ,{align:"end",children:[M&&(0,s.jsx)(f._2,{onClick:M,children:"Rename Folder"}),$&&(0,s.jsx)(f._2,{variant:"destructive",onClick:$,children:"Delete Folder"})]})]}),es?(0,s.jsxs)(f.rI,{children:[(0,s.jsx)(f.ty,{asChild:!0,children:(0,s.jsx)("button",{className:"flex items-center gap-2",children:(0,s.jsx)(q,{})})}),(0,s.jsxs)(f.SQ,{align:"end",children:[(0,s.jsxs)(f._2,{disabled:!0,className:"flex flex-col items-start",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:null!=(a=es.fullName)?a:"Signed in"}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:es.email})]}),(0,s.jsxs)(f._2,{onClick:ec,className:"text-red-600",children:[(0,s.jsx)(m.A,{className:"mr-2 h-4 w-4"}),"Sign out"]})]})]}):(0,s.jsx)(h.$,{onClick:eo,disabled:ei,className:"gap-2",children:"Sign in"})]}):"canvas"===ee?(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[C&&y&&(0,s.jsx)(V,{creatorEmail:y}),F&&!C&&(0,s.jsx)(Q,{}),w&&v&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(h.$,{variant:"outline",className:"gap-2",onClick:()=>et(!0),children:[(0,s.jsx)(o.A,{className:"h-4 w-4"}),"Share"]}),(0,s.jsx)(B,{projectId:v,projectName:b||"Untitled Project",shareToken:w,creatorEmail:y||"",isCreator:N,isOpen:ea,onClose:()=>et(!1)})]}),es?(0,s.jsxs)(f.rI,{children:[(0,s.jsx)(f.ty,{asChild:!0,children:(0,s.jsx)("button",{className:"flex items-center gap-2",children:(0,s.jsx)(q,{})})}),(0,s.jsxs)(f.SQ,{align:"end",children:[(0,s.jsxs)(f._2,{disabled:!0,className:"flex flex-col items-start",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:null!=(t=es.fullName)?t:"Signed in"}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:es.email})]}),(0,s.jsxs)(f._2,{onClick:ec,className:"text-red-600",children:[(0,s.jsx)(m.A,{className:"mr-2 h-4 w-4"}),"Sign out"]})]})]}):(0,s.jsx)(h.$,{onClick:eo,disabled:ei,className:"gap-2",children:"Sign in"})]}):(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[L&&(0,s.jsxs)(h.$,{onClick:L,className:"gap-2",children:[(0,s.jsx)(c.A,{className:"h-4 w-4"}),"New Project"]}),es?(0,s.jsxs)(f.rI,{children:[(0,s.jsx)(f.ty,{asChild:!0,children:(0,s.jsx)("button",{className:"flex items-center gap-2",children:(0,s.jsx)(q,{})})}),(0,s.jsxs)(f.SQ,{align:"end",children:[(0,s.jsxs)(f._2,{disabled:!0,className:"flex flex-col items-start",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:null!=(u=es.fullName)?u:"Signed in"}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:es.email})]}),(0,s.jsxs)(f._2,{onClick:ec,className:"text-red-600",children:[(0,s.jsx)(m.A,{className:"mr-2 h-4 w-4"}),"Sign out"]})]})]}):(0,s.jsx)(h.$,{onClick:eo,disabled:ei,className:"gap-2",children:"Sign in"})]})})]})})}var Y=t(6436);function H(e){let{isOpen:a,pages:t,currentPageId:l,onPageSelect:i,onPageRename:n,onPageCreate:o,onPageDelete:c,isReadOnly:d=!1}=e,[m,h]=(0,r.useState)(null),[u,x]=(0,r.useState)(""),[p,f]=(0,r.useState)(!1),j=e=>{h(e.id),x(e.name)},v=async e=>{if(u.trim()&&n){f(!0);try{await n(e,u.trim()),h(null),x(""),N.oR.success("Page renamed successfully")}catch(e){N.oR.error("Failed to rename page. Please try again."),console.error("Failed to rename page:",e)}finally{f(!1)}}};return(0,s.jsx)("aside",{className:"bg-[var(--color-background-primary)] border-r border-[var(--color-border-primary)] h-full flex-shrink-0",style:{width:"var(--sidebar-width)"},children:(0,s.jsxs)("div",{className:"flex flex-col h-full p-[var(--spacing-2xl)]",children:[(0,s.jsx)("div",{className:"flex-1 space-y-0 overflow-y-auto",children:0===t.length?(0,s.jsx)("div",{className:"text-[var(--color-text-secondary)] text-center py-[var(--spacing-xl)]",style:{fontSize:"var(--font-size-sm)"},children:"No pages yet"}):t.map(e=>(0,s.jsx)("div",{children:m===e.id?(0,s.jsx)("div",{className:"flex items-center p-[var(--spacing-sm)] rounded-[var(--radius-md)]",children:(0,s.jsx)(g.p,{type:"text",value:u,onChange:e=>x(e.target.value),onBlur:()=>!p&&v(e.id),onKeyDown:a=>{"Enter"===a.key&&v(e.id),"Escape"===a.key&&(h(null),x(""))},className:"flex-1 bg-[var(--color-background-secondary)] text-[var(--color-text-primary)] border-[var(--color-border-secondary)] focus:border-[var(--color-accent-primary)] focus:ring-[var(--color-accent-primary)]/20",style:{fontSize:"var(--font-size-sm)"},disabled:p,autoFocus:!0})}):d?(0,s.jsx)("div",{className:"flex items-center p-[var(--spacing-sm)] rounded-[var(--radius-md)] cursor-pointer transition-all ".concat(l===e.id?"bg-[var(--color-background-tertiary)]":"hover:bg-[var(--color-background-secondary)] opacity-50 hover:opacity-100"),onClick:()=>null==i?void 0:i(e.id),children:(0,s.jsx)("span",{className:"text-[var(--color-text-primary)] font-[var(--font-weight-normal)] flex-1",style:{fontSize:"var(--font-size-sm)"},children:e.name})}):(0,s.jsxs)(Y.tz,{children:[(0,s.jsx)(Y.Rc,{asChild:!0,children:(0,s.jsx)("div",{className:"flex items-center p-[var(--spacing-sm)] rounded-[var(--radius-md)] cursor-pointer transition-all ".concat(l===e.id?"bg-[var(--color-background-tertiary)]":"hover:bg-[var(--color-background-secondary)] opacity-50 hover:opacity-100"),onClick:()=>null==i?void 0:i(e.id),children:(0,s.jsx)("span",{className:"text-[var(--color-text-primary)] font-[var(--font-weight-normal)] flex-1",style:{fontSize:"var(--font-size-sm)"},onDoubleClick:a=>{a.stopPropagation(),j(e)},children:e.name})})}),(0,s.jsxs)(Y.Ip,{children:[(0,s.jsx)(Y.kt,{onClick:()=>j(e),children:"Rename"}),t.length>1&&(0,s.jsx)(Y.kt,{variant:"destructive",onClick:()=>(e=>{if(t.length<=1)return void N.oR.error("Cannot delete the last page");null==c||c(e),N.oR.success("Page deleted successfully")})(e.id),children:"Delete"})]})]})},e.id))}),!d&&o&&(0,s.jsx)("div",{className:"pt-[var(--spacing-lg)] border-t border-[var(--color-border-primary)] mt-[var(--spacing-lg)]",children:(0,s.jsxs)("button",{onClick:o,className:"flex items-center gap-[var(--spacing-sm)] w-full p-[var(--spacing-sm)] rounded-[var(--radius-md)] text-[var(--color-text-secondary)] hover:text-[var(--color-text-primary)] hover:bg-[var(--color-background-secondary)] transition-all cursor-pointer",style:{fontSize:"var(--font-size-sm)"},children:[(0,s.jsx)("span",{className:"text-lg",children:"+"}),(0,s.jsx)("span",{children:"New Page"})]})})]})})}function X(e){let{children:a,mode:t,projectId:l,projectName:i,shareToken:n,creatorEmail:o,isCreator:c=!1,isCollaborator:d=!1,isReadOnly:m=!1,currentFolderId:h,folders:u=[],onProjectNameUpdate:x,onMoveToFolder:p,onRemoveFromFolder:f,onArtifactAdded:g,folderId:j,folderName:v,onFolderNameUpdate:b,onFolderShare:w,onFolderRename:y,onFolderDelete:N,onNewProject:k,columns:C,onColumnsChange:F,showColumnControls:S,fitMode:A,onFitModeChange:R,pages:P,currentPageId:z,onPageSelect:U,onPageRename:_,onPageCreate:I,onPageDelete:O,onBackToHome:T}=e,[E,M]=(0,r.useState)(!1),[$,L]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let e=window.localStorage.getItem("sidebar_open");null!==e&&M(JSON.parse(e)),L(!0)},[]),(0,r.useEffect)(()=>{$&&window.localStorage.setItem("sidebar_open",JSON.stringify(E))},[E,$]),(0,s.jsxs)("div",{className:"h-screen flex flex-col bg-[var(--color-background-primary)] text-[var(--color-text-primary)]",style:{fontFamily:"var(--font-family-primary)"},children:[(0,s.jsx)(K,{mode:t,projectId:l,projectName:i,shareToken:n,creatorEmail:o,isCreator:c,isCollaborator:d,isReadOnly:m,currentFolderId:h,folders:u,folderId:j,folderName:v,onBackToHome:T,onToggleSidebar:"canvas"===t?()=>{M(e=>!e)}:void 0,sidebarOpen:E,onProjectNameUpdate:x,onMoveToFolder:p,onRemoveFromFolder:f,onArtifactAdded:g,onFolderNameUpdate:b,onFolderShare:w,onFolderRename:y,onFolderDelete:N,onNewProject:k,currentPageId:z,columns:C,onColumnsChange:F,showColumnControls:S,fitMode:A,onFitModeChange:R}),(0,s.jsxs)("div",{className:"flex flex-1 min-h-0 relative",children:["canvas"===t&&E&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-[5] lg:hidden animate-in fade-in duration-300",style:{animationTimingFunction:"var(--spring-elegant-easing-light)"},onClick:()=>M(!1)}),"canvas"===t&&(0,s.jsx)("div",{className:"absolute top-0 left-0 h-full z-10 ".concat(E?"translate-x-0":"-translate-x-full"),style:{transition:"transform 400ms var(--spring-elegant-easing-light)"},children:(0,s.jsx)(H,{isOpen:!0,pages:P||[],currentPageId:z,onPageSelect:U,onPageRename:_,onPageCreate:I,onPageDelete:O,isReadOnly:m})}),(0,s.jsx)("main",{className:"flex-1 min-w-0",style:{marginLeft:"canvas"===t&&E?"var(--sidebar-width)":"0",transition:"margin-left 400ms var(--spring-elegant-easing-light)"},children:a})]})]})}},6835:(e,a,t)=>{function s(e){try{let a=new URL(e).hostname;return a.startsWith("www.")&&(a=a.substring(4)),a}catch(t){let a=e.match(/^https?:\/\/(?:www\.)?([^\/]+)/);return a?a[1]:"URL"}}function r(e,a,t){switch(e){case"image":case"video":case"pdf":if(t)return function(e){if(e instanceof File){let a=e.name,t=a.lastIndexOf(".");return t>0?a.substring(0,t):a}let a=e.toString(),t=a.split("/").pop()||a,s=t.lastIndexOf(".");return s>0?t.substring(0,s):t}(t);return s(a);case"url":case"figma":return s(a);default:return"".concat(e.charAt(0).toUpperCase()+e.slice(1)," Artifact")}}t.d(a,{Rr:()=>r})},8998:(e,a,t)=>{t.d(a,{QM:()=>r,lu:()=>l,validateFile:()=>i});var s=t(626);async function r(e,a){let t=await (0,s.yv)();console.log("Uploading file to Quick.fs:",e.name,e.type,e.size);let r=await t.fs.uploadFile(e,{onProgress:e=>{console.log("Upload progress:",e),null==a||a(e)}});return console.log("Quick.fs upload result:",r),{url:r.url,fullUrl:r.fullUrl,size:r.size,mimeType:r.mimeType}}function l(e){if(e.startsWith("image/"));else if(e.startsWith("video/"))return"video";return"image"}function i(e,a){let t=1024*((null==a?void 0:a.maxSizeMB)||50)*1024;return e.size>t?{valid:!1,error:"File size exceeds ".concat((null==a?void 0:a.maxSizeMB)||50,"MB limit. Try compressing your file.")}:(null==a?void 0:a.allowedTypes)&&!a.allowedTypes.includes(e.type)?{valid:!1,error:"File type ".concat(e.type," is not allowed")}:{valid:!0}}}}]);