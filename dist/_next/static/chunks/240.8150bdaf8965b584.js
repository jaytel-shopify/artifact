"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[240],{3713:(e,t,l)=>{l.d(t,{BT:()=>c,Wu:()=>o,ZB:()=>n,Zp:()=>i,aR:()=>s,wL:()=>d});var r=l(8045);l(5177);var a=l(6816);function i(e){let{className:t,...l}=e;return(0,r.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...l})}function s(e){let{className:t,...l}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...l})}function n(e){let{className:t,...l}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",t),...l})}function c(e){let{className:t,...l}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",t),...l})}function o(e){let{className:t,...l}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",t),...l})}function d(e){let{className:t,...l}=e;return(0,r.jsx)("div",{"data-slot":"card-footer",className:(0,a.cn)("flex items-center px-6 [.border-t]:pt-6",t),...l})}},7859:(e,t,l)=>{l.r(t),l.d(t,{default:()=>S});var r=l(8045),a=l(5177),i=l(3713),s=l(1266);function n(e){let{url:t,metadata:l}=e,n=(0,a.useMemo)(()=>(function(e){try{let t=new URL(e);if("http:"===t.protocol||"https:"===t.protocol)return t.toString();return null}catch(e){return null}})(t),[t]),[c,o]=(0,a.useState)(null),[d,u]=(0,a.useState)(null),h=(0,a.useRef)(null),[m,f]=(0,a.useState)(1),[x,p]=(0,a.useState)(()=>(0,s.OG)(s.di).height),v=(0,a.useMemo)(()=>{if("number"==typeof(null==l?void 0:l.width)&&"number"==typeof(null==l?void 0:l.height))return{width:l.width,height:l.height};let e=null==l?void 0:l.viewport;return e&&s.y8[e]?(0,s.OG)(e):(0,s.OG)(s.di)},[null==l?void 0:l.height,null==l?void 0:l.width,null==l?void 0:l.viewport]);return((0,a.useLayoutEffect)(()=>{let e=h.current;if(!e)return;let t=()=>{let t=e.clientWidth;if(!t||!v.width)return;let l=t/v.width;f(l),p(v.height*l)};t();let l=null;return"undefined"!=typeof ResizeObserver?(l=new ResizeObserver(()=>t())).observe(e):window.addEventListener("resize",t),()=>{null==l||l.disconnect(),window.removeEventListener("resize",t)}},[v.height,v.width]),(0,a.useEffect)(()=>{let e=!0;if(n)return(async()=>{try{var t;let l=await fetch("/api/embed/preview?url=".concat(encodeURIComponent(n))),r=await l.json();if(!e)return;o(null!=(t=r.allowEmbed)&&t),u({title:r.title||n,description:r.description||"",iconUrl:r.iconUrl||null})}catch(t){e&&o(!1)}})(),()=>{e=!1}},[n]),n)?!0===c?(0,r.jsx)("div",{ref:h,className:"w-full",style:{position:"relative",height:"".concat(x,"px"),overflow:"hidden"},children:(0,r.jsx)("div",{className:"shadow-2xl border border-white/10",style:{position:"absolute",top:0,left:0,width:"".concat(v.width,"px"),height:"".concat(v.height,"px"),transform:"scale(".concat(m,")"),transformOrigin:"top left",pointerEvents:"auto"},children:(0,r.jsx)("iframe",{src:n,width:v.width,height:v.height,className:"w-full h-full",allow:"clipboard-write; fullscreen; autoplay; encrypted-media; picture-in-picture",referrerPolicy:"no-referrer-when-downgrade",style:{border:0}})})}):(0,r.jsx)("div",{ref:h,className:"w-full flex items-start",children:(0,r.jsxs)(i.Zp,{className:"max-w-xl w-full bg-white/80 backdrop-blur border border-white/20 shadow-2xl",children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(null==d?void 0:d.iconUrl)&&(0,r.jsx)("img",{src:d.iconUrl,alt:"",className:"w-10 h-10 flex-shrink-0"}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)(i.ZB,{className:"text-gray-900 truncate text-base",children:(null==d?void 0:d.title)||n}),(null==d?void 0:d.description)&&(0,r.jsx)(i.BT,{className:"text-gray-600 line-clamp-3 mt-1",children:d.description})]})]})}),(0,r.jsx)(i.wL,{className:"pt-0",children:(0,r.jsx)("a",{href:n,target:"_blank",rel:"noreferrer noopener",className:"text-blue-600 hover:underline text-sm",children:"Open in new tab"})})]})}):(0,r.jsx)("div",{className:"p-4 text-sm text-red-600",children:"Invalid URL"})}var c=l(2989);function o(e){let{src:t,alt:l}=e,i=(0,a.useMemo)(()=>(function(e){try{return new URL(e).hostname.includes("quick.shopify.io")}catch(e){return!1}})(t),[t]),s="w-full h-auto";return i?(0,r.jsx)(c.default,{src:t,alt:l||"",width:2e3,height:1500,className:s}):(0,r.jsx)("img",{src:t,alt:l||"",className:s})}function d(e){let{src:t,poster:l,metadata:i}=e,s=(0,a.useRef)(null),n=!(null==i?void 0:i.hideUI),c=(null==i?void 0:i.loop)||!1,o=(null==i?void 0:i.muted)!==!1;return(0,a.useEffect)(()=>{let e=s.current;if(!e||!c)return;let t=async()=>{try{await e.play()}catch(e){console.log("Auto-play blocked for looping video:",e)}};return e.readyState>=1?t():e.addEventListener("loadedmetadata",t,{once:!0}),()=>{e.removeEventListener("loadedmetadata",t)}},[c,t]),(0,r.jsx)("video",{ref:s,src:t,poster:l,controls:n,loop:c,muted:o,playsInline:!0,className:"w-full h-auto cursor-pointer",onClick:()=>{if(n)return;let e=s.current;e&&(e.paused?e.play():e.pause())}})}function u(e){let{src:t}=e;return(0,r.jsx)("iframe",{src:"".concat(t,"#toolbar=0&navpanes=0"),className:"w-full h-auto",allow:"fullscreen"})}var h=l(3173),m=l(7651);function f(e){let{title:t,artifactId:l,onUpdate:i,className:s=""}=e,[n,c]=(0,a.useState)(!1),[o,d]=(0,a.useState)(t),[u,f]=(0,a.useState)(!1),x=(0,a.useRef)(null);(0,a.useEffect)(()=>{d(t)},[t]),(0,a.useEffect)(()=>{n&&x.current&&(x.current.focus(),x.current.select())},[n]);let p=(0,a.useCallback)(()=>{c(!0)},[]),v=(0,a.useCallback)(async()=>{if(o.trim()===t.trim())return void c(!1);f(!0);try{await i(o.trim()||"Untitled"),c(!1),o.trim()!==t.trim()&&m.oR.success("Artifact title updated")}catch(e){m.oR.error("Failed to update title. Please try again."),console.error("Failed to update artifact title:",e),d(t)}finally{f(!1)}},[o,t,i]),w=(0,a.useCallback)(()=>{d(t),c(!1)},[t]),g=(0,a.useCallback)(e=>{"Enter"===e.key?(e.preventDefault(),v()):"Escape"===e.key&&(e.preventDefault(),w())},[v,w]),j=(0,a.useCallback)(()=>{v()},[v]);return n?(0,r.jsx)("div",{className:"text-center ".concat(s),children:(0,r.jsx)(h.p,{ref:x,type:"text",value:o,onChange:e=>d(e.target.value),onKeyDown:g,onBlur:j,disabled:u,placeholder:"Untitled",className:"h-6 text-xs text-center bg-transparent border-0 focus:bg-white focus:text-gray-800 focus:border-gray-300 px-1 py-0.5 min-w-0 w-full max-w-full",style:{fontSize:"14px",lineHeight:"1.2",minWidth:"60px",maxWidth:"440px"}})}):(0,r.jsx)("div",{className:"text-center cursor-pointer hover:bg-white/5 rounded-md px-2 py-1 transition-colors duration-200 ".concat(s),onDoubleClick:p,title:"Double-click to edit",children:(0,r.jsx)("div",{className:"text-xs text-gray-400 truncate select-none",style:{fontSize:"14px",lineHeight:"1.2",maxWidth:"440px",margin:"0 auto"},children:o||"Untitled"})})}var x=l(6436),p=l(6655),v=l(4922),w=l(5078),g=l(5376),j=l(6174),y=l(3816),b=l(1003),N=l(9317),k=l(557);function R(e){let{artifact:t,width:l,columnHeight:a,children:i}=e,{attributes:s,listeners:n,setNodeRef:c,transform:o,transition:d,isDragging:u}=(0,N.gl)({id:t.id}),h={width:l,minHeight:"100%",scrollSnapAlign:"start",transition:d||"width 260ms cubic-bezier(0.33, 1, 0.68, 1)",transform:k.Ks.Transform.toString(o),opacity:u?.1:1,cursor:u?"grabbing":"grab",touchAction:"manipulation"};return(0,r.jsx)("div",{ref:c,style:h,"data-artifact-id":t.id,className:"inline-flex flex-col align-top shrink-0 h-full",...s,...n,children:(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)("div",{className:"overflow-y-auto",style:{maxHeight:a?"".concat(a,"px"):void 0},children:(0,r.jsx)("div",{className:"overflow-hidden",children:i})})})})}function E(e){let{artifact:t,maxHeight:l}=e;return(0,r.jsx)("div",{className:"pointer-events-none overflow-y-auto",style:{maxHeight:l?"".concat(l,"px"):void 0},children:(0,r.jsx)("div",{className:"overflow-hidden",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("div",{className:"text-xs text-gray-400 truncate select-none px-2 py-1",style:{fontSize:"14px",lineHeight:"1.2",maxWidth:"440px",margin:"0 auto"},children:t.name||"Untitled"})})}),(0,r.jsx)("div",{children:(0,r.jsx)(C,{artifact:t})})]})})})}function C(e){let{artifact:t}=e;return"image"===t.type?(0,r.jsx)(o,{src:t.source_url,alt:""}):"url"===t.type?(0,r.jsx)(n,{url:t.source_url}):"video"===t.type?(0,r.jsx)(d,{src:t.source_url}):"pdf"===t.type?(0,r.jsx)(u,{src:t.source_url}):(0,r.jsx)("div",{className:"text-sm text-white/70",children:"Unsupported"})}function S(e){let{columns:t,artifacts:l,onReorder:i,onUpdateArtifact:s,onDeleteArtifact:n}=e,[c,o]=(0,a.useState)(l),[d,u]=(0,a.useState)(null),[h,k]=(0,a.useState)(!1),C=(0,a.useRef)(null);(0,a.useEffect)(()=>{o(l)},[l]);let S=(0,b.FR)((0,b.MS)(b.AN,{activationConstraint:{distance:6}})),[L,A]=(0,a.useState)(!1),[I,_]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=window.matchMedia("(any-pointer: coarse)"),t=()=>A(e.matches);t(),e.addEventListener("change",t);let l=()=>{A(!1),window.removeEventListener("wheel",l)};return window.addEventListener("wheel",l,{passive:!0}),()=>{e.removeEventListener("change",t),window.removeEventListener("wheel",l)}},[]),(0,a.useLayoutEffect)(()=>{let e=C.current;if(!e)return;let t=()=>_(e.clientHeight);t();let l=()=>t(),r=null;return"undefined"!=typeof ResizeObserver?(r=new ResizeObserver(l)).observe(e):window.addEventListener("resize",l),()=>{null==r||r.disconnect(),window.removeEventListener("resize",l)}},[c.length]);let z=(0,a.useMemo)(()=>"calc((100% - ".concat((t-1)*32,"px) / ").concat(t,")"),[t,32]),D=(0,a.useCallback)(e=>{let{active:t,over:l}=e;requestAnimationFrame(()=>{u(null),k(!1)}),l&&t.id!==l.id&&o(e=>{let r=e.findIndex(e=>e.id===t.id),a=e.findIndex(e=>e.id===l.id);if(-1===r||-1===a)return e;let s=(0,N.be)(e,r,a);return null==i||i(s),s})},[i]),F=(0,a.useCallback)(e=>{u(e.active.id),k(!0)},[]),H=(0,a.useCallback)(e=>{let t=C.current,l=e.active.rect.current.translated;if(!t||!l)return;let r=t.getBoundingClientRect();l.right>r.right-120?t.scrollBy({left:28,behavior:"auto"}):l.left<r.left+120&&t.scrollBy({left:-28,behavior:"auto"})},[]),O=(0,a.useCallback)(e=>{let{artifact:t,children:l}=e,a="video"===t.type,i=t.metadata,c=async()=>{if(!s)return;let e={...t.metadata,hideUI:!(null==i?void 0:i.hideUI)};try{await s(t.id,{metadata:e}),m.oR.success((null==i?void 0:i.hideUI)?"Video controls enabled":"Video controls hidden")}catch(e){m.oR.error("Failed to update video settings")}},o=async()=>{if(!s)return;let e={...t.metadata,loop:!(null==i?void 0:i.loop)};try{await s(t.id,{metadata:e}),m.oR.success((null==i?void 0:i.loop)?"Video loop disabled":"Video loop enabled")}catch(e){m.oR.error("Failed to update video settings")}},d=async()=>{if(!s)return;let e=(null==i?void 0:i.muted)!==!1,l={...t.metadata,muted:!e};try{await s(t.id,{metadata:l}),m.oR.success(e?"Video unmuted":"Video muted")}catch(e){m.oR.error("Failed to update video settings")}};return(0,r.jsxs)(x.tz,{children:[(0,r.jsx)(x.Rc,{asChild:!0,children:(0,r.jsx)("div",{className:"group relative",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{"data-artifact-title-id":t.id,children:(0,r.jsx)(f,{title:t.name,artifactId:t.id,onUpdate:e=>{var l;return null!=(l=null==s?void 0:s(t.id,{name:e}))?l:Promise.resolve()},className:"mb-6"})}),(0,r.jsx)("div",{children:l})]})})}),(0,r.jsxs)(x.Ip,{children:[a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(x.kt,{onClick:c,className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(null==i?void 0:i.hideUI)?null:(0,r.jsx)(p.A,{className:"w-3 h-3"})}),(null==i?void 0:i.hideUI)?(0,r.jsx)(w.A,{className:"w-4 h-4"}):(0,r.jsx)(v.A,{className:"w-4 h-4"}),"Show Controls"]}),(0,r.jsxs)(x.kt,{onClick:o,className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(null==i?void 0:i.loop)?(0,r.jsx)(p.A,{className:"w-3 h-3"}):null}),(0,r.jsx)(g.A,{className:"w-4 h-4"}),"Loop Video"]}),(0,r.jsxs)(x.kt,{onClick:d,className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(null==i?void 0:i.muted)===!1?(0,r.jsx)(p.A,{className:"w-3 h-3"}):null}),(null==i?void 0:i.muted)!==!1?(0,r.jsx)(j.A,{className:"w-4 h-4"}):(0,r.jsx)(y.A,{className:"w-4 h-4"}),"Audio On"]}),(0,r.jsx)(x.kt,{disabled:!0,className:"h-px bg-border p-0 m-1"})]}),(0,r.jsx)(x.kt,{variant:"destructive",onClick:async()=>{try{await (null==n?void 0:n(t.id)),m.oR.success('"'.concat(t.name,'" deleted successfully'))}catch(e){m.oR.error("Failed to delete artifact. Please try again."),console.error("Failed to delete artifact:",e)}},children:"Delete"})]})]})},[s,n]);return 0===c.length?(0,r.jsx)("div",{className:"h-full flex items-center justify-center text-white/60",children:"No artifacts yet. Add one to get started."}):(0,r.jsxs)(b.Mp,{sensors:S,collisionDetection:b.fp,onDragStart:F,onDragMove:H,onDragEnd:D,children:[(0,r.jsx)("div",{className:"h-full",children:(0,r.jsx)("div",{ref:C,className:"w-full h-full overflow-x-auto overflow-y-hidden flex items-stretch ".concat(L?"":"hide-scrollbar"),style:{gap:"".concat(32,"px"),scrollSnapType:h?"none":"x mandatory",scrollPaddingInline:"".concat(32,"px"),paddingInline:"".concat(32,"px")},children:(0,r.jsx)(N.gB,{items:c.map(e=>e.id),strategy:N.m$,children:c.map(e=>(0,r.jsx)(R,{artifact:e,width:z,columnHeight:null!=I?I:void 0,children:(0,r.jsx)(O,{artifact:e,children:(0,r.jsx)(U,{artifact:e})})},e.id))})})}),(0,r.jsx)(b.Hd,{children:d?(0,r.jsx)(E,{artifact:c.find(e=>e.id===d),maxHeight:null!=I?I:void 0}):null})]})}function U(e){let{artifact:t}=e;return"image"===t.type?(0,r.jsx)(o,{src:t.source_url,alt:""}):"url"===t.type?(0,r.jsx)(n,{url:t.source_url,metadata:t.metadata}):"video"===t.type?(0,r.jsx)(d,{src:t.source_url,metadata:t.metadata}):"pdf"===t.type?(0,r.jsx)(u,{src:t.source_url}):(0,r.jsxs)("div",{className:"h-full flex items-center justify-center text-sm text-gray-500",children:["Unsupported type: ",t.type]})}}}]);